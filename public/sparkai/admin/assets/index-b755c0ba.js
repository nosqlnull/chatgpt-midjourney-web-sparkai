
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as ue}from"./index-c786b651.js";import{d as re,r as b,Q as k,t as se,o as w,c as S,e as l,f as a,R as F,S as N,b as v,k as u,w as de,I as x,x as C,P as V,E as h,h as s,X as ie,q as L}from"./index-56458f60.js";import{p as O,U as pe,o as me}from"./index-70c9cd4a.js";import{u as Q}from"./utcformatTime-e76e5157.js";const fe=re({__name:"index",setup(ce){const j=b(),$=b(0),I=b(!1),M=b(!1),y=b(!1),U=b(0),A=b(),g=k({status:0,id:0}),m=k({model3Count:0,model4Count:0,drawMjCount:0}),d=k({username:"",email:"",status:"",page:1,size:15}),X=k({model3Count:[{required:!0,message:"请填写赠送一般AI模型额度",trigger:"blur"}],model4Count:[{required:!0,message:"请填写赠送增强AI模型额度",trigger:"blur"}],drawMjCount:[{required:!0,message:"请填写赠送MJ绘画积分",trigger:"blur"}]}),z=b([]);async function _(){try{M.value=!0;const n=await V.queryAllUser(d),{rows:t,count:p}=n.data;M.value=!1,$.value=p,z.value=t}catch{M.value=!1}}function G(n){I.value=!0,g.status=n.status,g.id=n.id}function H(n){y.value=!0,U.value=n.id}async function K(){(await V.updateUserStatus(g)).success&&h({type:"success",message:"变更用户状态成功！"}),I.value=!1,_()}function W(n){n==null||n.resetFields(),_()}async function Z(n){const{id:t,email:p}=n;(await V.resetUserPassword({id:t})).success&&h({type:"success",message:`重置用户[${p}密码为初始密码为[123456]完成！`})}function E(n){U.value=0,n==null||n.resetFields()}async function ee(n){n==null||n.validate(async t=>{t&&(await V.sendUserCrami({...m,userId:U.value}),h.success("赠送用户成功！"),y.value=!1,_())})}return se(()=>_()),(n,t)=>{const p=s("el-input"),i=s("el-form-item"),D=s("el-option"),R=s("el-select"),f=s("el-button"),T=s("el-form"),P=ue,o=s("el-table-column"),q=s("el-tag"),le=s("el-popconfirm"),ae=s("el-table"),te=s("el-pagination"),ne=s("el-row"),J=s("el-dialog"),oe=ie("loading");return w(),S("div",null,[l(P,null,{default:a(()=>[l(T,{ref_key:"formRef",ref:j,inline:!0,model:d},{default:a(()=>[l(i,{label:"用户名称",prop:"username"},{default:a(()=>[l(p,{modelValue:d.username,"onUpdate:modelValue":t[0]||(t[0]=e=>d.username=e),placeholder:"用户姓名[模糊搜索]",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"用户邮箱",prop:"email"},{default:a(()=>[l(p,{modelValue:d.email,"onUpdate:modelValue":t[1]||(t[1]=e=>d.email=e),placeholder:"用户邮箱[模糊搜索]",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"用户状态",prop:"status"},{default:a(()=>[l(R,{modelValue:d.status,"onUpdate:modelValue":t[2]||(t[2]=e=>d.status=e),placeholder:"请选择用户状态",clearable:""},{default:a(()=>[(w(!0),S(F,null,N(v(O),e=>(w(),x(D,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(f,{type:"primary",onClick:_},{default:a(()=>[u(" 查询 ")]),_:1}),l(f,{onClick:t[3]||(t[3]=e=>W(j.value))},{default:a(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(P,{style:{width:"100%"}},{default:a(()=>[de((w(),x(ae,{border:"",data:z.value,style:{width:"100%"},size:"large"},{default:a(()=>[l(o,{fixed:"",prop:"username",label:"用户名称",width:"150"}),l(o,{prop:"id",label:"用户ID",width:"80"}),l(o,{prop:"email",label:"用户邮箱",width:"250",align:"left"}),l(o,{prop:"status",label:"用户状态",width:"120",align:"center"},{default:a(({row:e})=>[l(q,{type:v(pe)[e.status]},{default:a(()=>[u(C(v(me)[e.status]),1)]),_:2},1032,["type"])]),_:1}),l(o,{prop:"balanceInfo.model3Count",label:"一般AI模型",width:"120",align:"center"}),l(o,{prop:"balanceInfo.model4Count",label:"增强AI模型",width:"120",align:"center"}),l(o,{prop:"balanceInfo.drawMjCount",label:"MJ余额",width:"120",align:"center"}),u("expirationTime "),l(o,{prop:"balanceInfo.drawMjCount",label:"会员到期时间",width:"170",align:"center"},{default:a(e=>[l(q,{type:"success"},{default:a(()=>{var r,c,Y,B;return[u(C((c=(r=e.row)==null?void 0:r.balanceInfo)!=null&&c.expirationTime?v(Q)(new Date((B=(Y=e.row)==null?void 0:Y.balanceInfo)==null?void 0:B.expirationTime)):"非会员"),1)]}),_:2},1024)]),_:1}),l(o,{prop:"balanceInfo.memberModel3Count",label:"一般AI模型[会员]",width:"120",align:"center"}),l(o,{prop:"balanceInfo.memberModel4Count",label:"增强AI模型[会员]",width:"120",align:"center"}),l(o,{prop:"balanceInfo.memberDrawMjCount",label:"MJ余额[会员]",width:"120",align:"center"}),l(o,{prop:"balanceInfo.useModel3Count",label:"已用一般AI模型",width:"160",align:"center"},{default:a(e=>{var r,c;return[u(C(`${((r=e.row.balanceInfo)==null?void 0:r.useModel3Count)||0}次 | ${((c=e.row.balanceInfo)==null?void 0:c.useModel3Token)||0} Token`),1)]}),_:1}),l(o,{prop:"balanceInfo.useModel4Count",label:"已用增强AI模型",width:"160",align:"center"},{default:a(e=>{var r,c;return[u(C(`${((r=e.row.balanceInfo)==null?void 0:r.useModel4Count)||0}次 | ${((c=e.row.balanceInfo)==null?void 0:c.useModel4Token)||0} Token`),1)]}),_:1}),l(o,{prop:"balanceInfo.useDrawMjToken",label:"已用绘画MJ",width:"160",align:"center"},{default:a(e=>{var r;return[u(C(`${((r=e.row.balanceInfo)==null?void 0:r.useDrawMjToken)||0} Token`),1)]}),_:1}),l(o,{prop:"createdAt",label:"注册时间",width:"200",align:"center"},{default:a(e=>[u(C(v(Q)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),l(o,{fixed:"right",label:"操作",width:"250",align:"center"},{default:a(e=>[l(f,{link:"",type:"primary",size:"small",onClick:r=>G(e.row)},{default:a(()=>[u(" 修改状态 ")]),_:2},1032,["onClick"]),l(le,{title:"确认重置此用户密码为【123456】?","confirm-button-text":"确认重置",onConfirm:r=>Z(e.row)},{reference:a(()=>[l(f,{link:"",type:"danger"},{default:a(()=>[u(" 重置密码 ")]),_:1})]),_:2},1032,["onConfirm"]),l(f,{link:"",type:"primary",size:"small",onClick:r=>H(e.row)},{default:a(()=>[u(" 赠送卡密 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,M.value]]),l(ne,{class:"flex justify-end mt-5"},{default:a(()=>[l(te,{"current-page":d.page,"onUpdate:currentPage":t[4]||(t[4]=e=>d.page=e),"page-size":d.size,"onUpdate:pageSize":t[5]||(t[5]=e=>d.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:$.value,onSizeChange:_,onCurrentChange:_},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),l(J,{modelValue:I.value,"onUpdate:modelValue":t[7]||(t[7]=e=>I.value=e),title:"变更用户状态",width:"500px"},{default:a(()=>[l(T,{model:g,inline:!0},{default:a(()=>[l(i,{label:"用户状态","label-width":"90px"},{default:a(()=>[l(R,{modelValue:g.status,"onUpdate:modelValue":t[6]||(t[6]=e=>g.status=e),placeholder:"请选择用户状态",clearable:""},{default:a(()=>[(w(!0),S(F,null,N(v(O),e=>(w(),x(D,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(f,{type:"primary",onClick:K},{default:a(()=>[u(" 确认变更 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(J,{modelValue:y.value,"onUpdate:modelValue":t[13]||(t[13]=e=>y.value=e),title:"主动赠送用户",width:"450px",onClose:t[14]||(t[14]=e=>E(A.value))},{footer:a(()=>[l(f,{onClick:t[11]||(t[11]=e=>y.value=!1)},{default:a(()=>[u(" 放弃赠送 ")]),_:1}),l(f,{type:"primary",onClick:t[12]||(t[12]=e=>ee(A.value))},{default:a(()=>[u(" 确认赠送 ")]),_:1})]),default:a(()=>[l(T,{ref_key:"cramiRef",ref:A,model:m,rules:X,"label-width":"105px"},{default:a(()=>[l(i,{label:"一般AI模型",prop:"model3Count"},{default:a(()=>[l(p,{modelValue:m.model3Count,"onUpdate:modelValue":t[8]||(t[8]=e=>m.model3Count=e),modelModifiers:{number:!0},type:"number",placeholder:"赠送一般AI模型次数"},null,8,["modelValue"])]),_:1}),l(i,{label:"增强AI模型",prop:"model4Count"},{default:a(()=>[l(p,{modelValue:m.model4Count,"onUpdate:modelValue":t[9]||(t[9]=e=>m.model4Count=e),modelModifiers:{number:!0},type:"number",placeholder:"赠送增强AI模型次数"},null,8,["modelValue"])]),_:1}),l(i,{label:"MJ额度",prop:"drawMjCount"},{default:a(()=>[l(p,{modelValue:m.drawMjCount,"onUpdate:modelValue":t[10]||(t[10]=e=>m.drawMjCount=e),modelModifiers:{number:!0},type:"number",placeholder:"赠送携带MJ额度"},null,8,["modelValue"])]),_:1}),l(i,{class:"flex justify-end"})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});typeof L=="function"&&L(fe);export{fe as default};
