
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as N}from"./index-c786b651.js";import{a8 as O,d as j,r as _,Q as $,t as Q,o as d,c as b,e as l,f as t,R as h,S as A,b as u,k as p,w as X,I as w,x,P as G,E as H,h as s,X as J,q as T}from"./index-56458f60.js";import{P as K,g as W,h as Z,i as E}from"./index-70c9cd4a.js";import{u as ee}from"./utcformatTime-e76e5157.js";const V={queryAllOrder:f=>O.get("order/queryAll",{params:f}),deleteOrder:f=>O.post("order/delete",f)},le=j({__name:"index",setup(f){const m=_(!1),I=_([]),k=_(),P=_(0),o=$({userId:"",platform:"",status:"",page:1,size:15}),z=_([]);async function i(){m.value=!0;try{const r=await V.queryAllOrder(o);m.value=!1;const{rows:a,count:c}=r.data;P.value=c,z.value=a}catch{m.value=!1}}async function C(r){const a=await G.queryAllUser({size:30,username:r});I.value=a.data.rows}function U(r){r==null||r.resetFields(),i()}async function D(r){const{orderId:a}=r;await V.deleteOrder({orderId:a}),H.success("删除订单完成!"),i()}return Q(()=>{i()}),(r,a)=>{const c=s("el-option"),v=s("el-select"),g=s("el-form-item"),y=s("el-button"),M=s("el-form"),S=N,n=s("el-table-column"),Y=s("el-tag"),q=s("el-popconfirm"),R=s("el-table"),L=s("el-pagination"),F=s("el-row"),B=J("loading");return d(),b("div",null,[l(S,null,{default:t(()=>[l(M,{ref_key:"formRef",ref:k,inline:!0,model:o},{default:t(()=>[l(g,{label:"用户名称",prop:"userId"},{default:t(()=>[l(v,{modelValue:o.userId,"onUpdate:modelValue":a[0]||(a[0]=e=>o.userId=e),filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"用户姓名[模糊搜索]","remote-show-suffix":"","remote-method":C},{default:t(()=>[(d(!0),b(h,null,A(u(I),e=>(d(),w(c,{key:e.id,label:e.username,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,{label:"支付平台",prop:"platform"},{default:t(()=>[l(v,{modelValue:o.platform,"onUpdate:modelValue":a[1]||(a[1]=e=>o.platform=e),clearable:"",placeholder:"请选择支付平台","remote-show-suffix":""},{default:t(()=>[(d(!0),b(h,null,A(u(K),e=>(d(),w(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,{label:"支付状态",prop:"status"},{default:t(()=>[l(v,{modelValue:o.status,"onUpdate:modelValue":a[2]||(a[2]=e=>o.status=e),clearable:"",placeholder:"请选择支付状态","remote-show-suffix":""},{default:t(()=>[(d(!0),b(h,null,A(u(W),e=>(d(),w(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,null,{default:t(()=>[l(y,{type:"primary",onClick:i},{default:t(()=>[p(" 查询 ")]),_:1}),l(y,{onClick:a[3]||(a[3]=e=>U(u(k)))},{default:t(()=>[p(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(S,{style:{width:"100%"}},{default:t(()=>[X((d(),w(R,{border:"",data:u(z),style:{width:"100%"},size:"large","tooltip-options":{}},{default:t(()=>[l(n,{fixed:"",prop:"orderId",label:"订单ID",width:"315"}),l(n,{prop:"userInfo.username",label:"用户名称",width:"200"}),l(n,{prop:"userInfo.email",label:"用户邮箱",width:"200"}),l(n,{prop:"goodsInfo.name",label:"套餐名称",width:"110"}),l(n,{prop:"price",label:"商品单价",width:"110"}),l(n,{prop:"count",label:"购买数量",width:"90",align:"center"}),l(n,{prop:"total",label:"订单总价",width:"90",align:"center"}),l(n,{prop:"total",label:"支付平台",width:"90",align:"center"},{default:t(e=>[p(x(u(Z)[e.row.payPlatform]),1)]),_:1}),l(n,{prop:"status",label:"支付状态",width:"90",align:"center"},{default:t(e=>[l(Y,{type:e.row.status===1?"success":"warning"},{default:t(()=>[p(x(u(E)[e.row.status]),1)]),_:2},1032,["type"])]),_:1}),l(n,{prop:"createdAt",label:"订单时间",width:"200",fixed:"right"},{default:t(e=>[p(x(u(ee)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),l(n,{fixed:"right",label:"操作"},{default:t(e=>[l(q,{title:"确认删除此订单么、删除订单不可恢复?",width:"200","icon-color":"red",onConfirm:te=>D(e.row)},{reference:t(()=>[l(y,{link:"",type:"danger",size:"small"},{default:t(()=>[p(" 删除订单 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[B,u(m)]]),l(F,{class:"flex justify-end mt-5"},{default:t(()=>[l(L,{"current-page":o.page,"onUpdate:currentPage":a[4]||(a[4]=e=>o.page=e),"page-size":o.size,"onUpdate:pageSize":a[5]||(a[5]=e=>o.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:u(P),onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}});typeof T=="function"&&T(le);export{le as default};
